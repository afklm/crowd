#
# Dynamically generated by Chef on <%= node["fqdn"] %>
# Local modifications will be overwritten by Chef.
#

# Make a switch here for jdk 7 or jdk 8, jdk8 ignores max perm size
<% if node['java']['jdk_version'].to_s <= '7' %>
JAVA_OPTS="-Xms<%= node['crowd']['jvm']['minimum_memory'] %> -Xmx<%= node['crowd']['jvm']['maximum_memory'] %> -XX:MaxPermSize=<%= node['crowd']['jvm']['maximum_permgen'] %> -Dfile.encoding=UTF-8 $JAVA_OPTS"
<% else %>
JAVA_OPTS="-Xms<%= node['crowd']['jvm']['minimum_memory'] %> -Xmx<%= node['crowd']['jvm']['maximum_memory'] %> -Dfile.encoding=UTF-8 $JAVA_OPTS"
<% end %>
JAVA_OPTS="<%= node['crowd']['jvm']['java_opts'] %> $JAVA_OPTS"

export JAVA_OPTS

<% unless node['crowd']['pid'].empty? -%>
CATALINA_PID="<%= node['crowd']['pid'] %>"
<% end -%>

# set the location of the pid file
if [ -z "$CATALINA_PID" ] ; then
    if [ -n "$CATALINA_BASE" ] ; then
        CATALINA_PID="$CATALINA_BASE"/work/catalina.pid
    elif [ -n "$CATALINA_HOME" ] ; then
        CATALINA_PID="$CATALINA_HOME"/work/catalina.pid
    fi
fi

export CATALINA_PID
